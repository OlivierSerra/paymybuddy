<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Nouvelle transaction</title>
  <link rel="stylesheet" href="/style.css" th:href="@{/style.css}" />
  <style>
    :root{
  --brand:#1676f3;     /* bleu du bouton */
  --text:#1f2937;
  --muted:#6b7280;
  --field-border:#e6e9ef;
}
*{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
    }

/* Conteneur central */
.container {
  max-width: 980px;
  margin: 32px auto;
  padding: 0 24px;
}

.navbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:16px 24px;
      border-bottom:1px solid #eef1f5;
    }
.brand{
      font-weight:700;
      letter-spacing:.2px;
    }
.nav-links{
      display:flex; gap:28px;
    }
.nav-links a{
      color:inherit; text-decoration:none; font-size:14px;
    }

.nav-links a.active{ color:var(--accent); font-weight:700; }

/* Barre de transfert (les 3 champs + bouton) */
.transfer-bar{
  display:flex;
  align-items:center;
  gap:20px;
  flex-wrap:wrap;              /* passe à la ligne sur petits écrans */
  margin: 32px 0 28px;
}

/* Style commun aux champs */
.control{
  height:44px;
  border:1px solid var(--field-border);
  border-radius:8px;
  background:#fff;
  font-size:14px;
  padding:0 12px;
  outline:0;
}
.control:focus{
  border-color:#bcd3ff;
  box-shadow:0 0 0 3px rgba(22,118,243,.12);
}

/* Largeurs souhaitées pour coller à la maquette */
.select-rel { min-width:260px; }
.input-desc { flex:1 1 300px; }   /* prend l'espace restant */
.amount-group{ position:relative; width:140px; }
.amount-group .control{ width:100%; padding-right:28px; }

/* Ajoute le € dans le champ montant */
.amount-group::after{
  content:"€";
  position:absolute; right:12px; top:50%; transform:translateY(-50%);
  color:var(--muted); font-weight:600; pointer-events:none;
}

/* Bouton payer */
.btn-primary{
  height:44px;
  padding:0 22px;
  border:0;
  border-radius:8px;
  background:var(--brand);
  color:#fff;
  font-weight:700;
  cursor:pointer;
}
.btn-primary:hover{ filter:brightness(0.95); }

/* Carte / tableau des transactions */
.transactions-card{
  border:1px solid #eef1f5; border-radius:12px;
  padding: 0; background:#fff;
}

.transactions-card .card-header{
  padding:14px 16px; font-weight:700;
}

.table{
  width:100%; border-collapse:collapse;
}
.table th, .table td{
  padding:12px 16px;
}
.table thead th{ text-align:left; color:#111827; }
.table tbody tr + tr{ border-top:1px solid #f1f3f7; }
.table td.amount{ text-align:right; white-space:nowrap; }

  </style>
</head>
<body>

  <header class="navbar">
    <div class="brand">Pay My Buddy</div>
    <nav class="nav-links">
      <a th:href="@{/transactions/new}"
      th:classappend="${#httpServletRequest != null
                    and #strings.startsWith(#httpServletRequest.requestURI,'/transactions')}
                   ? 'active'">Transférer</a>
      <a th:href="@{/me}"
      th:classappend="${#httpServletRequest != null
                    and #strings.startsWith(#httpServletRequest.requestURI,'/me')} ? 'active'">Profil</a>
      <a th:href="@{/buddies}"
      th:classappend="${#httpServletRequest != null
                    and #strings.startsWith(#httpServletRequest.requestURI,'/buddies')} ? 'active'">Ajouter relation</a>
      <a th:href="@{/account}"
      th:classappend="${#httpServletRequest != null
                    and #strings.startsWith(#httpServletRequest.requestURI,'/account')} ? 'active'">Mon compte&solde</a>
      <a th:href="@{/login?logout}">Se déconnecter</a>
    </nav>
  </header>



<p th:if="${error}" th:text="${error}" style="color:red;"></p>
<p th:if="${success}" th:text="${success}" style="color:green;"></p>


<div class="container">
  <form th:action="@{/transactions}" method="post" th:object="${transaction}">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

    <div class="transfer-bar">
      <!-- Relation -->
      <select class="control select-rel" th:field="*{receiverEmail}">
        <option value="" disabled selected>Sélectionner une relation</option>
        <option th:each="u : ${users}"
                th:value="${u.email}"
                th:text="${u.username}">Utilisateur</option>
      </select>

      <!-- Description -->
      <input class="control input-desc" type="text"
             th:field="*{description}" placeholder="Description" />

      <!-- Montant -->
      <div class="amount-group">
        <input class="control" type="number" step="0.01" min="0"
               th:field="*{amount}" placeholder="0" />
      </div>

      <!-- Bouton -->
      <button class="btn-primary" type="submit">Payer</button>
    </div>
  </form>

  <!-- Carte / Tableau des transactions -->
  <section class="transactions-card">
  <div class="card-header">Mes Transactions</div>

  <div class="table-scroll">
    <table class="table">
        <thead>
          <tr>
            <th>Relations</th>
            <th>Description</th>
            <th style="text-align:right;">Montant</th>
          </tr>
          <tr th:each="t : ${transactions}">
            <td th:text="${t.userSender.email == me ? t.userReceiver.username : t.userSender.username}">
              Laure-Anne
            </td>
            <td th:text="${t.description}">Restaurant</td>
            <td class="amount"
                th:text="${#numbers.formatDecimal(t.amount, 1, 2)} + '€'">10€</td>
          </tr>

        </thead>
    </table>  
</div>

<hr/>


</body>
</html>
